"use strict";var ItemsDropdownView=Parse.View.extend({id:"items-dropdown",className:"dropdown",tagName:"li",events:{},template:_.template($("#items-dropdown-view-template").text()),initialize:function(){$("#navbar-dropdowns").append(this.el),this.render()},render:function(){var a=this,b=new Parse.Query("Item");b.limit(5),b.find({success:function(b){a.$el.html(a.template({items:b}))},error:function(a){console.log(a)}})}}),ProductsDropdownView=Parse.View.extend({id:"products-dropdown",className:"dropdown",tagName:"li",events:{},template:_.template($("#products-dropdown-view-template").text()),initialize:function(){$("#navbar-dropdowns").append(this.el),this.render()},render:function(){var a=this,b=new Parse.Query("Product");b.limit(5),b.find({success:function(b){a.$el.html(a.template({products:b}))},error:function(a){console.log(a)}})}}),AdminItemView=Parse.View.extend({className:"admin-item-view-container slidable-view",events:{"click #upload-image":"uploadImage","click #save-item-changes":"saveItemChanges","click #cancel-changes":"redirectBack"},template:_.template($("#admin-item-view-template").text()),initialize:function(a){$(".view-container").append(this.el),this.render(a,!0)},render:function(a,b){b="undefined"!=typeof b?b:!1;var c=this,d=new Parse.Query("Item"),e=new Parse.Query("Product");d.equalTo("objectId",a),d.include("product"),e.find({success:function(a){d.find({success:function(d){var e=c.template({products:a,item:d[0]});b?c.slideIn(e,c.$el):c.$el.html(e)},error:function(a){console.log(a)}})},error:function(a){console.log(a)}})},uploadImage:function(){$("#image-file-selector").click()},saveItemChanges:function(a){var b=this,c=a.target.dataset.itemId,d=$("#image-file-selector")[0].files[0],e=d?d.name:null,f=$("#image-name").val(),g=new Parse.File(e,d),h=$("#item-name").val(),i=$("#item-description").val(),j=$("#item-product-category").val(),k=$("#item-product-category").children(":selected").attr("id"),l=parseInt($("#item-quantity").val()),m=parseFloat($("#item-price").val()),n="YES"===$("#item-featured").val()?!0:!1,o=new Parse.Query("Item"),p={__type:"Pointer",className:"Product",objectId:k};if(!(""!==h&&""!==i&&l>0&&j&&(d||f)&&m>0))return sweetAlert("Oops!","Looks like you forgot to enter some item info.","error");$("#save-item-changes").text("Saving Changes..."),$("#save-item-changes").attr("disabled",!0);var q={name:h,description:i,quantity:l,featured:n,product:p,price:m};e&&(q.image=g),o.get(c,{success:function(a){a.set(q).save({success:function(){sweetAlert("Success!","Your item has been updated.","success"),b.redirectBack(),CHESSON_COUNTRY_GLOBALS.itemsDropdownView.render()},error:function(a){sweetAlert("Oops!","Your item was unable to be updated.","error"),b.redirectBack(),console.log("Error "+a.code+" : "+a.message),console.log("Error "+a)}})},error:function(a){console.log(a)}})},redirectBack:function(){router.navigate("/#admin")}}),ItemView=Parse.View.extend({className:"item-view-container slidable-view",events:{},template:_.template($("#item-view-template").text()),initialize:function(a){$(".view-container").append(this.el),this.render(a,!0)},render:function(a,b){b="undefined"!=typeof b?b:!1;var c=this,d=new Parse.Query("Item"),e=new Parse.Query("Item"),f="http://chessoncountry.com",g="//www.facebook.com/sharer/sharer.php",h="//twitter.com/share",i="//plus.google.com/share",j="//pinterest.com/pin/create/button",k="@ChessonCountry";d.include("product"),d.get(a,{success:function(a){var d={__type:"Pointer",className:"Product",objectId:a.attributes.product.id};e.equalTo("product",d),e.find({success:function(d){var e=c.template({item:a,relatedItems:d.slice(0,5),itemsCount:d.length,facebookLink:g+"?u="+f+"/%23items/"+a.id,twitterLink:h+"?url="+f+"/%23items/"+a.id+"&text="+a.attributes.name+"&via="+k,googlePlusLink:i+"?url="+f+"/%23items/"+a.id,pinterestLink:j+"?url="+f+"/%23items/"+a.id+"&media="+a.attributes.image._url+"&description="+a.attributes.name+"  |  "+a.attributes.description});b?c.slideIn(e,c.$el):c.$el.html(e)},error:function(a){console.log(a)}})},error:function(a){console.log(a)}})}}),ItemsView=Parse.View.extend({className:"items-view-container slidable-view",events:{},template:_.template($("#items-view-template").text()),initialize:function(){$(".view-container").append(this.el),this.render(!0)},render:function(a){a="undefined"!=typeof a?a:!1;var b=this,c=new Parse.Query("Item");c.find({success:function(c){var d=b.template({items:c});a?b.slideIn(d,b.$el):b.$el.html(d)},error:function(a){console.log(a)}})}}),ProductView=Parse.View.extend({className:"product-view-container slidable-view",events:{},template:_.template($("#product-view-template").text()),initialize:function(a){$(".view-container").append(this.el),this.render(a,!0)},render:function(a,b){b="undefined"!=typeof b?b:!1;var c=this,d=new Parse.Query("Item"),e={__type:"Pointer",className:"Product",objectId:a};d.equalTo("product",e),d.find({success:function(a){var d=c.template({items:a});b?c.slideIn(d,c.$el):c.$el.html(d)},error:function(a){console.log(a)}})}}),ProductsView=Parse.View.extend({className:"products-view-container slidable-view",events:{},template:_.template($("#products-view-template").text()),initialize:function(){$(".view-container").append(this.el),this.render(!0)},render:function(a){a="undefined"!=typeof a?a:!1;var b=this,c=new Parse.Query("Product");c.find({success:function(c){var d=b.template({products:c});a?b.slideIn(d,b.$el):b.$el.html(d)},error:function(a){console.log(a)}})}}),AdminView=Parse.View.extend({className:"admin-view-container slidable-view",events:{"click #logout-button":"logout","click #add-new-product":"addNewProduct","click #add-new-item":"addNewItem","click #upload-image":"uploadImage","click .delete-product":"deleteProduct","click .edit-product":"editProduct","click .update-product":"updateProduct","click .cancel-product-update":"render","click .delete-item":"deleteItem","click .edit-item":"editItem","keypress #product-name":"productKeypress","keypress #product-description":"productKeypress","keypress #item-name":"itemKeypress","keypress #item-description":"itemKeypress","keypress #item-product-category":"itemKeypress","keypress #item-price":"itemKeypress","keypress #item-quantity":"itemKeypress","keypress #item-featured":"itemKeypress"},template:_.template($("#admin-view-template").text()),initialize:function(){$(".view-container").append(this.el),this.render(!0)},render:function(a){a="undefined"!=typeof a?a:!1;var b=this,c=new Parse.Query("Product"),d=new Parse.Query("Item");d.include("product"),c.find({success:function(c){d.find({success:function(d){var e=b.template({products:c,items:d});a?b.slideIn(e,b.$el):b.$el.html(e)},error:function(a){console.log(a)}})},error:function(a){console.log(a)}})},logout:function(){Parse.User.logOut(),$("#header-login-button a").text("Login"),router.navigate("/#login")},addNewProduct:function(){var a=$("#product-name").val(),b=$("#product-description").val(),c=new Product,d=this;return""===a||""===b?sweetAlert("Oops!","Looks like you forgot to enter the name or description.","error"):void c.save({name:a,description:b},{success:function(){sweetAlert("Success!","Your new product has been created.","success"),d.render(),CHESSON_COUNTRY_GLOBALS.productsDropdownView.render()},error:function(){sweetAlert("Oops!","New product was unable to be created","error"),console.log("Error "+error.code+" : "+error.message),console.log("Error "+error)}})},addNewItem:function(){var a=this,b=$("#image-file-selector")[0].files[0],c=b?b.name:null,d=new Parse.File(c,b),e=$("#item-name").val(),f=$("#item-description").val(),g=$("#item-product-category").val(),h=$("#item-product-category").children(":selected").attr("id"),i=parseInt($("#item-quantity").val()),j=parseFloat($("#item-price").val()),k="YES"===$("#item-featured").val()?!0:!1,l=new Item,m={__type:"Pointer",className:"Product",objectId:h};return""!==e&&""!==f&&i>0&&g&&b&&j>0?($("#add-new-item").text("Adding Item..."),$("#add-new-item").attr("disabled",!0),void l.save({name:e,description:f,quantity:i,featured:k,product:m,image:d,price:j},{success:function(){sweetAlert("Success!","Your new item has been created.","success"),a.render(),CHESSON_COUNTRY_GLOBALS.itemsDropdownView.render()},error:function(a){sweetAlert("Oops!","New item was unable to be created","error"),console.log("Error "+a.code+" : "+a.message),console.log("Error "+a)}})):sweetAlert("Oops!","Looks like you forgot to enter some item info.","error")},productKeypress:function(a){13===a.which&&this.addNewProduct()},itemKeypress:function(a){13===a.which&&this.addNewItem()},uploadImage:function(){$("#image-file-selector").click()},deleteProduct:function(a){var b=this,c=a.target.dataset.productId,d=new Parse.Query("Product"),e=new Parse.Query("Item"),f={__type:"Pointer",className:"Product",objectId:c};e.equalTo("product",f),d.get(c,{success:function(a){e.find({success:function(c){var d=c.length;d>0?sweetAlert({title:"Are you sure?",text:"You will not be able to recover this product!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(){sweetAlert({title:"Delete Items as well?",text:"There are currently "+d.toString()+" items associated with this Product. Would you like to delete those as well?",type:"info",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete the items!",cancelButtonText:"No, keep the items!",closeOnConfirm:!1},function(d){a.destroy(),d&&c.forEach(function(a){a.destroy()}),swal("Deleted!","This product has been successfully removed.","success"),b.render(),CHESSON_COUNTRY_GLOBALS.productsDropdownView.render(),CHESSON_COUNTRY_GLOBALS.itemsDropdownView.render()})}):sweetAlert({title:"Are you sure?",text:"You will not be able to recover this product!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(){a.destroy(),swal("Deleted!","This product has been successfully removed.","success"),b.render(),CHESSON_COUNTRY_GLOBALS.productsDropdownView.render()})},error:function(a){console.log(a)}})},error:function(a){console.log(a)}})},editProduct:function(a){var b=a.target.dataset.productId,c='&nbsp;&nbsp;<span class="glyphicon glyphicon-floppy-disk"></span>',d='&nbsp;&nbsp;<span class="glyphicon glyphicon-ban-circle"></span>',e=$($("#edit-product-"+b).parents("tr").children("td")[0]),f=$($("#edit-product-"+b).parents("tr").children("td")[1]);e.html('<input id="edit-product-name" type="text" value="'+e.text()+'" data-original-value="'+e.text()+'">'),f.html('<input id="edit-product-description" type="text" value="'+f.text()+'" data-original-value="'+f.text()+'">'),$("#edit-product-"+b).removeClass("edit-product"),$("#edit-product-"+b).removeClass("btn-info"),$("#edit-product-"+b).addClass("update-product"),$("#edit-product-"+b).html("Save Update"+c),$("#delete-product-"+b).removeClass("delete-product"),$("#delete-product-"+b).addClass("cancel-product-update"),$("#delete-product-"+b).html("Cancel Update"+d)},updateProduct:function(a){var b=this,c=a.target.dataset.productId,d=new Parse.Query("Product"),e=$("#edit-product-"+c).parents("tr").find("input")[0].value,f=$("#edit-product-"+c).parents("tr").find("input")[1].value;d.get(c,{success:function(a){a.set("name",e),a.set("description",f),a.save({success:function(){sweetAlert("Success!","The product has been updated.","success"),b.render(),CHESSON_COUNTRY_GLOBALS.productsDropdownView.render()},error:function(a){sweetAlert("Oops!","The product was unable to be updated.","error"),console.log(a)}})},error:function(a){sweetAlert("Oops!","The product was unable to be updated.","error"),console.log(a)}}),$(".cancel-product-update#delete-product-"+c).click(),$($("#edit-product-"+c).parents("tr").children("td")[0]).html(e),$($("#edit-product-"+c).parents("tr").children("td")[1]).html(f)},deleteItem:function(a){var b=this,c=a.target.dataset.itemId,d=new Parse.Query("Item");d.get(c,{success:function(a){sweetAlert({title:"Are you sure?",text:"You will not be able to recover this item!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(){a.destroy(),sweetAlert("Deleted!","This item has been successfully removed.","success"),b.render(),CHESSON_COUNTRY_GLOBALS.itemsDropdownView.render()})},error:function(a){console.log(a)}})},editItem:function(a){router.navigate("/#admin/item/"+a.target.dataset.itemId)}}),LoginView=Parse.View.extend({className:"login-view-container slidable-view",events:{"click #login-button":"login","keypress #username-input-box":"keypress","keypress #password-input-box":"keypress"},template:_.template($("#login-view-template").text()),initialize:function(){$(".view-container").html(this.el),this.render(!0)},render:function(a){a="undefined"!=typeof a?a:!1,a?_this.slideIn(this.template,_this.$el):_this.$el.html(this.template)},login:function(){var a=$("#username-input-box").val(),b=$("#password-input-box").val();a.length>0&&b.length>0?Parse.User.logIn(a,b,{success:function(){$("#header-login-button a").text("Admin"),router.navigate("/#admin")},error:function(){sweetAlert("Oops!","Looks like you've entered the wrong username or password.","error")}}):sweetAlert("Oops!","Looks like you forgot to enter a username and password.","error")},keypress:function(a){13===a.which&&this.login()}}),HomeView=Parse.View.extend({className:"home-view-container slidable-view",events:{},template:_.template($("#home-view-template").text()),initialize:function(){$(".view-container").append(this.el),this.render(!0)},render:function(a){a="undefined"!=typeof a?a:!1;var b=this,c=new Parse.Query("Item");c.include("product"),c.include("photo"),c.equalTo("featured",!0),c.find({success:function(c){var d={items:c},e=b.template(d);a?b.slideIn(e,b.$el):b.$el.html(e)},error:function(a){console.log(a)}})}}),Product=Parse.Object.extend({className:"Product"}),Products=Parse.Collection.extend({model:Product}),Item=Parse.Object.extend({className:"Item"}),Items=Parse.Collection.extend({model:Item}),products=new Products,items=new Items,Router=Parse.Router.extend({routes:{"":"renderHome","/#":"renderHome",products:"renderProducts","products/:productId":"renderProduct",items:"renderItems","items/:itemId":"renderItem",login:"renderLogin",admin:"renderAdmin","admin/item/:itemId":"renderAdminItem"},initialize:function(){this.navOptions=null,this.currentView=null},renderHome:function(){this.swapView(new HomeView)},renderProducts:function(){this.swapView(new ProductsView)},renderProduct:function(a){this.swapView(new ProductView(a))},renderItems:function(){this.swapView(new ItemsView)},renderItem:function(a){this.swapView(new ItemView(a))},renderAdmin:function(){Parse.User.current()?this.swapView(new AdminView):router.navigate("/#")},renderAdminItem:function(a){this.swapView(new AdminItemView(a))},renderLogin:function(){this.swapView(new LoginView)},swapView:function(a){$(".mountains").removeClass("mountains-shown",1e3),this.currentView&&this.currentView.$el.animate({"margin-left":"-2000px","margin-right":"2000px"},200,function(){this.remove()}),this.currentView=a,setTimeout(function(){$(document).height()-70<=$(window).height()?$(".mountains").addClass("mountains-shown",1e3):$(".mountains").removeClass("mountains-shown",1e3)},1e3)}});Parse.initialize("Jhy8OKg078ZS0kqcovgTUTOWGVR24uLBaAbgVWr1","5YB6DJc5NNwAbp73polr1FpMRmO37VDdgaJDgGWt");var router=new Router;Parse.history.start();var CHESSON_COUNTRY_GLOBALS={productsDropdownView:{},itemsDropdownView:{}};Parse.View.prototype.slideIn=function(a,b){b.html(a).show(0,function(){b.animate({"margin-left":"0px"},200)})},$(document).ready(function(){CHESSON_COUNTRY_GLOBALS.productsDropdownView=new ProductsDropdownView,CHESSON_COUNTRY_GLOBALS.itemsDropdownView=new ItemsDropdownView,$(window).scroll(function(){$(window).scrollTop()>$(document).height()-$(window).height()-70?$(".mountains").addClass("mountains-shown",1e3):$(".mountains").removeClass("mountains-shown",1e3)}),$("#header-login-button a").text(Parse.User.current()?"Admin":"Login"),$("#header-login-button").on("click",function(){router.navigate(Parse.User.current()?"/#admin":"/#login")}),$(".logo").on("click",function(){router.navigate("/#")}),$("#featured-items-link").click(function(){window.location.href.replace(window.location.origin,"").length>2&&router.navigate("/#");var a=setInterval(function(){$("#featured-items")&&($("html, body").animate({scrollTop:$("#featured-items").offset().top-80},"slow"),clearInterval(a))},500)}),$(document).on("change","#image-file-selector",function(){$("#image-name").val($("#image-file-selector").val())})});